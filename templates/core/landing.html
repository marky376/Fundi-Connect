{% extends 'base/base.html' %}

{% block title %}FundiConnect - Find Skilled Workers in Kenya{% endblock %}

{% block content %}
{% if user.is_authenticated and 'fundi' in user.roles and user.active_role == 'customer' %}
    <div class="container mb-4 text-end">
        <a href="{% url 'switch_role' %}?role=fundi" class="btn btn-outline-primary">
            <i class="bi bi-arrow-repeat me-1"></i>Switch to Fundi Mode
        </a>
    </div>
{% endif %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold mb-4">
                    Connect with Skilled <span class="text-warning">Fundis</span> in Kenya
                </h1>
                <p class="lead mb-4">
                    Need a job done? Find trusted professionals for plumbing, electrical work, carpentry, 
                    and more. Or showcase your skills and grow your business.
                </p>
                <div class="d-flex flex-column flex-md-row gap-3">
                    <a href="{% url 'customer_signup' %}" class="btn btn-light btn-lg px-4">
                        <i class="bi bi-person-plus me-2"></i>Join as Customer
                    </a>
                    <a href="{% url 'account_signup' %}" class="btn btn-outline-light btn-lg px-4">
                        <i class="bi bi-tools me-2"></i>Join as Fundi
                    </a>
                </div>
            </div>
            <div class="col-lg-6 mt-5 mt-lg-0">
                <div class="text-center">
                    <i class="bi bi-people-fill display-1 text-warning opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Categories -->
<section class="py-5" id="popular-services">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-3">Popular Services</h2>
            <p class="text-muted">Find professionals for these common services</p>
        </div>
        
        <div class="row g-4">
            {% if categories %}
                {% for category in categories %}
                <div class="col-md-3 col-6">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <div class="mb-3">
                                {% if category.name == 'Plumbing' %}
                                    <i class="bi bi-wrench display-6 text-primary"></i>
                                {% elif category.name == 'Electrical' %}
                                    <i class="bi bi-lightning display-6 text-warning"></i>
                                {% elif category.name == 'Carpentry' %}
                                    <i class="bi bi-hammer display-6 text-success"></i>
                                {% elif category.name == 'Cleaning' %}
                                    <i class="bi bi-house display-6 text-info"></i>
                                {% else %}
                                    <i class="bi bi-tools display-6 text-primary"></i>
                                {% endif %}
                            </div>
                            <h6 class="card-title">{{ category.name }}</h6>
                            <p class="card-text text-muted small">{{ category.description|truncatewords:8 }}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-md-3 col-6">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-wrench display-6 text-primary mb-3"></i>
                            <h6 class="card-title">Plumbing</h6>
                            <p class="card-text text-muted small">Repairs, installations, maintenance</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-lightning display-6 text-warning mb-3"></i>
                            <h6 class="card-title">Electrical</h6>
                            <p class="card-text text-muted small">Wiring, outlets, lighting</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-hammer display-6 text-success mb-3"></i>
                            <h6 class="card-title">Carpentry</h6>
                            <p class="card-text text-muted small">Furniture, repairs, custom work</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-house display-6 text-info mb-3"></i>
                            <h6 class="card-title">Cleaning</h6>
                            <p class="card-text text-muted small">Deep cleaning, maintenance</p>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</section>

<!-- Featured Jobs -->
{% if jobs %}
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-3">Latest Job Requests</h2>
            <p class="text-muted">Recent opportunities from customers</p>
        </div>
        
        <div class="row g-4">
            {% for job in jobs %}
            <div class="col-lg-4 col-md-6">
                <div class="card job-card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <h6 class="card-title mb-0">{{ job.title }}</h6>
                            <span class="badge bg-primary badge-urgency">{{ job.get_urgency_display }}</span>
                        </div>
                        <p class="card-text text-muted small mb-3">{{ job.description|truncatewords:15 }}</p>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <small class="text-muted">
                                <i class="bi bi-geo-alt me-1"></i>{{ job.location }}
                            </small>
                            {% if job.budget_min %}
                                <small class="text-success fw-bold">
                                    KES {{ job.budget_min }}{% if job.budget_max %} - {{ job.budget_max }}{% endif %}
                                </small>
                            {% endif %}
                        </div>
                        <small class="text-muted">
                            <i class="bi bi-clock me-1"></i>{{ job.created_at|timesince }} ago
                        </small>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="{% url 'job_detail' job.id %}" class="btn btn-outline-primary btn-sm w-100">
                            View Details <i class="bi bi-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="{% url 'job_list' %}" class="btn btn-primary">
                View All Jobs <i class="bi bi-arrow-right ms-1"></i>
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- Call to Action -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 mb-4">
                <div class="card border-primary h-100">
                    <div class="card-body text-center p-5">
                        <div class="mb-3">
                            <i class="bi bi-briefcase display-4 text-primary"></i>
                        </div>
                        <h4 class="card-title text-primary">Need a Job Done?</h4>
                        <p class="card-text">Post your job request and get connected with skilled Fundis in your area.</p>
                        
                        <!-- Updated link to customer signup -->
                        <a href="{% url 'customer_signup' %}" class="btn btn-primary">
                            Post a Job <i class="bi bi-plus-circle ms-1"></i>
                        </a>
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="card border-success h-100">
                    <div class="card-body text-center p-5">
                        <div class="mb-3">
                            <i class="bi bi-tools display-4 text-success"></i>
                        </div>
                        <h4 class="card-title text-success">Are You a Fundi?</h4>
                        <p class="card-text">Join our platform to find customers and grow your business with verified jobs.</p>
                        <a href="{% url 'account_signup' %}" class="btn btn-success">
                            Join as Fundi <i class="bi bi-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Customer Reviews Section -->
<section class="py-5 bg-white">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-3">What Customers Say</h2>
            <p class="text-muted">Real feedback from happy customers</p>
        </div>
        <div class="row g-4 justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Customer" class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <h6 class="mb-0 fw-bold">James Mwangi</h6>
                                <small class="text-muted">Nairobi</small>
                            </div>
                        </div>
                        <p class="card-text">"FundiConnect made it so easy to find a reliable plumber. The job was done quickly and professionally!"</p>
                        <div class="text-warning">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Customer" class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <h6 class="mb-0 fw-bold">Grace Wanjiru</h6>
                                <small class="text-muted">Mombasa</small>
                            </div>
                        </div>
                        <p class="card-text">"I posted a job for carpentry and got connected to a skilled fundi within hours. Highly recommend!"</p>
                        <div class="text-warning">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="https://randomuser.me/api/portraits/men/65.jpg" alt="Customer" class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <h6 class="mb-0 fw-bold">Peter Otieno</h6>
                                <small class="text-muted">Kisumu</small>
                            </div>
                        </div>
                        <p class="card-text">"The fundi I hired for electrical work was very knowledgeable and friendly. Great experience!"</p>
                        <div class="text-warning">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="https://randomuser.me/api/portraits/women/68.jpg" alt="Customer" class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <h6 class="mb-0 fw-bold">Mercy Njeri</h6>
                                <small class="text-muted">Eldoret</small>
                            </div>
                        </div>
                        <p class="card-text">"I love how easy it is to communicate with fundis on the app. My cleaning job was done perfectly!"</p>
                        <div class="text-warning">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="https://randomuser.me/api/portraits/men/21.jpg" alt="Customer" class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <h6 class="mb-0 fw-bold">Samuel Kariuki</h6>
                                <small class="text-muted">Thika</small>
                            </div>
                        </div>
                        <p class="card-text">"FundiConnect is my go-to for home repairs. The fundis are professional and trustworthy."</p>
                        <div class="text-warning">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}